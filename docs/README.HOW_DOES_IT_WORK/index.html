<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>How is "rarreg.key" generated? - WinRAR Online Key Generator</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "How is \"rarreg.key\" generated?";
        var mkdocs_page_input_path = "README.HOW_DOES_IT_WORK.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> WinRAR Online Key Generator
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">WinRAR Key File Generator.</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">How is "rarreg.key" generated?</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#1-composite-field">1. Composite field</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#2-elliptic-curve-over">2. Elliptic curve over</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#3-message-hash-algorithm">3. Message hash algorithm</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#4-ecc-digital-signature-algorithm">4. ECC digital signature algorithm</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#5-winrar-private-key-generation-algorithm">5. WinRAR private key generation algorithm</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#6-the-private-key-and-public-key-of-winrar">6. The private key and public key of WinRAR</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#7-generation-of-rarregkey">7. Generation of "rarreg.key"</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../GF/">Arithmetic on the Galois Field GF(2<sup>n</sup>) and GF((2<sup>n</sup>)<sup>m</sup>).</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../EC/">Elliptic Curve Point Addition For y^2 + xy = x^3 + a x^2 + b.</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">WinRAR Online Key Generator</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">How is "rarreg.key" generated?</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/YJTSAI-17/WinRAR-KeyGen-Online/edit/master/docs/README.HOW_DOES_IT_WORK.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="how-is-rarregkey-generated">How is "rarreg.key" generated?</h1>
<p>WinRAR uses an ECC-based signature algorithm to generate <code>rarreg.key</code>. The algorithm it used is a variant of Chinese SM2 digital signature algorithm. Different to many standard ECDSAs, the curve that WinRAR selected is a curve over composite field <img alt="GF2p15p17-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20%5Ctextrm%7BGF%7D%28%282%5E%7B15%7D%29%5E%7B17%7D%29" />.</p>
<h2 id="1-composite-field">1. Composite field <img alt="GF2p15p17-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20%5Ctextrm%7BGF%7D%28%282%5E%7B15%7D%29%5E%7B17%7D%29" /></h2>
<p>Elements in ground field <img alt="GF2p15-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20%5Ctextrm%7BGF%7D%282%5E%7B15%7D%29" /> are represented with standard basis, i.e. polynomial basis. The irreducible polynomial is</p>
<p style="text-align: center;">
    <img src="http://latex.codecogs.com/svg.latex?P%28%5Calpha%29%3D%5Calpha%5E%7B15%7D&plus;%5Calpha&plus;1">
</p>

<p>where each coefficients is in <img alt="GF2-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20%5Ctextrm%7BGF%7D%282%29" />. If we use </p>
<p style="text-align: center;">
    <img src="http://latex.codecogs.com/svg.latex?B_1%3D%5C%7B1%2C%5Calpha%2C%5Calpha%5E2%2C%5Cldots%2C%5Calpha%5E%7B14%7D%5C%7D">
</p>

<p>as the standard basis of the ground field, an element <img alt="A-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20A" /> in <img alt="GF2p15-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20%5Ctextrm%7BGF%7D%282%5E%7B15%7D%29" /> can be denoted as</p>
<p style="text-align: center;">
    <img src="http://latex.codecogs.com/svg.latex?A%3D%5Csum_%7Bi%3D0%7D%5E%7B14%7Da_i%5Calpha%5Ei%20%5Cquad%20%5Cquad%20%5Cquad%20a_i%5Cin%5Ctextrm%7BGF%7D%282%29">
</p>

<hr />
<p>The irreducible polynomial of composite field <img alt="GF2p15p17-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20%5Ctextrm%7BGF%7D%28%282%5E%7B15%7D%29%5E%7B17%7D%29" /> is</p>
<p style="text-align: center;">
    <img src="http://latex.codecogs.com/svg.latex?Q%28%5Cbeta%29%3D%5Cbeta%5E%7B17%7D&plus;%5Cbeta%5E3&plus;1">
</p>

<p>where each coefficients is in <img alt="GF2p15-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20%5Ctextrm%7BGF%7D%282%5E%7B15%7D%29" />. If we use </p>
<p style="text-align: center;">
    <img src="http://latex.codecogs.com/svg.latex?B_2%3D%5C%7B1%2C%5Cbeta%2C%5Cbeta%5E2%2C%5Cldots%2C%5Cbeta%5E%7B16%7D%5C%7D">
</p>

<p>as the standard basis of the composite field, an element <img alt="B-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20B" /> in <img alt="GF2p15p17-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20%5Ctextrm%7BGF%7D%28%282%5E%7B15%7D%29%5E%7B17%7D%29" /> can be denoted as</p>
<p style="text-align: center;">
    <img src="http://latex.codecogs.com/svg.latex?B%3D%5Csum_%7Bj%3D0%7D%5E%7B16%7D%28%5Csum_%7Bi%3D0%7D%5E%7B14%7Da_%7Bj%2Ci%7D%5Calpha%5Ei%29%5Cbeta%5Ej%3D%5Csum_%7Bj%3D0%7D%5E%7B16%7D%5Csum_%7Bi%3D0%7D%5E%7B14%7Da_%7Bj%2Ci%7D%5Calpha%5Ei%5Cbeta%5Ej%20%5Cquad%20%5Cquad%20%5Cquad%20a_%7Bj%2Ci%7D%5Cin%5Ctextrm%7BGF%7D%282%29">
</p>

<hr />
<p>For clarity, we use <img alt="D-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20D" />, which is a 255-bits-long integer to denote an element <img alt="B-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20B" /> in <img alt="GF2p15p17-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20%5Ctextrm%7BGF%7D%28%282%5E%7B15%7D%29%5E%7B17%7D%29" />. The map between them is</p>
<p style="text-align: center;">
    <img src="http://latex.codecogs.com/svg.latex?B%3D%5Csum_%7Bj%3D0%7D%5E%7B16%7D%5Csum_%7Bi%3D0%7D%5E%7B14%7Da_%7Bj%2Ci%7D%5Calpha%5Ei%5Cbeta%5Ej%20%5Cleftrightarrow%20D%3D%5Csum_%7Bj%3D0%7D%5E%7B16%7D%5Csum_%7Bi%3D0%7D%5E%7B14%7Da_%7Bj%2Ci%7D%5Ccdot%202%5E%7B15j&plus;i%7D">
</p>

<h2 id="2-elliptic-curve-over">2. Elliptic curve over <img alt="GF2p15p17-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20%5Ctextrm%7BGF%7D%28%282%5E%7B15%7D%29%5E%7B17%7D%29" /></h2>
<p>The equation of the elliptic curve that WinRAR uses is</p>
<p style="text-align: center;">
    <img src="http://latex.codecogs.com/svg.latex?y%5E2&plus;xy%3Dx%5E3&plus;161%20%5Cquad%20%5Cquad%20%5Cquad%20161%5Cin%5Ctextrm%7BGF%7D%28%282%5E%7B15%7D%29%5E%7B17%7D%29">
</p>

<p>The base point <img alt="G-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20G" /> is</p>
<p style="text-align: center;">
    <img src="http://latex.codecogs.com/svg.latex?%5Cbegin%7Baligned%7D%20G%26%3D%28G_x%2CG_y%29%20%5C%5C%20G_x%26%3D%5Ctextrm%7B0x56fdcbc6a27acee0cc2996e0096ae74feb1acf220a2341b898b549440297b8cc%7D%20%5Cquad%20G_x%5Cin%5Ctextrm%7BGF%7D%28%282%5E%7B15%7D%29%5E%7B17%7D%29%5C%5C%20G_y%26%3D%5Ctextrm%7B0x20da32e8afc90b7cf0e76bde44496b4d0794054e6ea60f388682463132f931a7%7D%20%5Cquad%20G_y%5Cin%5Ctextrm%7BGF%7D%28%282%5E%7B15%7D%29%5E%7B17%7D%29%20%5Cend%7Baligned%7D">
</p>

<p>whose order <img alt="n-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20n" /> is</p>
<p style="text-align: center;">
    <img src="http://latex.codecogs.com/svg.latex?n%3D%5Ctextrm%7B0x1026dd85081b82314691ced9bbec30547840e4bf72d8b5e0d258442bbcd31%7D%20%5Cquad%20n%5Cin%5Cnolinebreak%5Cmathbb%7BZ%7D">
</p>

<h2 id="3-message-hash-algorithm">3. Message hash algorithm</h2>
<p>We use </p>
<p style="text-align: center;">
    <img src="http://latex.codecogs.com/svg.latex?M%3Dm_0m_1%20%5Cldots%20m_%7Bl-1%7D%20%5Cquad%20%5Cquad%20m_i%5Cin%5B0%2C%20256%29">
</p>

<p>to denote a message whose length is <img alt="l-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20l" />. So the SHA1 value of <img alt="M-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20M" /> should be </p>
<p style="text-align: center;">
    <img src="http://latex.codecogs.com/svg.latex?%5Ctextrm%7BSHA%7D_1%28M%29%3DS_0%7C%7CS_1%7C%7CS_2%7C%7CS_3%7C%7CS_4%20%5Cquad%20%5Cquad%20S_i%5Cin%5B0%2C%202%5E%7B32%7D%29">
</p>

<p>where <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20S_0%2CS_1%2CS_2%2CS_3%2CS_4" /> are 5 state values when SHA1 outputs. Generally speaking, the final SHA1 value should be the join of these 5 state values while each of state values is serialized in big-endian.</p>
<p>However, WinRAR doesn't serialize the 5 state values. Instead, it use a big integer <img alt="h-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20h" /> as the hash of the input message.</p>
<p style="text-align: center;">
    <img src="http://latex.codecogs.com/svg.latex?h%3D%28%5Csum_%7Bi%3D0%7D%5E%7B4%7DS_i%20%5Ccdot%202%5E%7B32i%7D%29&plus;%5Ctextrm%7B0x1bd10xb4e33c7c0ffd8d43%7D%20%5Ccdot%202%5E%7B32*5%7D">
</p>

<h2 id="4-ecc-digital-signature-algorithm">4. ECC digital signature algorithm</h2>
<p>We use <img alt="k-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20k" /> to denote private key, <img alt="P-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20P" /> to denote public key. So there must be</p>
<p style="text-align: center;">
    <img src="http://latex.codecogs.com/svg.latex?P%3Dk%20%5Ccdot%20G">
</p>

<p>If we use <img alt="h-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20h" /> to denote the hash of input data, WinRAR use the following algorithm to perform signing:</p>
<ol>
<li>
<p>Generate a random big integer <img alt="Rnd-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20Rnd" /> which satisfies <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%200%3CRnd%3Cn" />.</p>
</li>
<li>
<p>Calculate <img alt="r-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20r" /></p>
</li>
</ol>
<p style="text-align: center;">
       <img src="http://latex.codecogs.com/svg.latex?r%3D%28%28Rnd%20%5Ccdot%20G%29_x&plus;h%29%5C%20%5C%20Mod%5C%20%5C%20n">
   </p>

<p>where <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20%28Rnd%20%5Ccdot%20G%29_x" /> means we take X coordinate of <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20Rnd%20%5Ccdot%20G" /> and convert it from <img alt="GF2p15p17-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20%5Ctextrm%7BGF%7D%28%282%5E%7B15%7D%29%5E%7B17%7D%29" /> to a big integer.</p>
<p>If <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20r%3D0" /> or <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20r&plus;Rnd%3Dn" />, go back to step 1.</p>
<ol>
<li>Calculate <img alt="s-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20s" /></li>
</ol>
<p style="text-align: center;">
       <img src="http://latex.codecogs.com/svg.latex?s%3D%28Rnd-kr%29%5C%20%5C%20Mod%5C%20%5C%20n">
   </p>

<p>If <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20s%3D0" />, go back to step 1.</p>
<ol>
<li>Output <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20%28r%2Cs%29" />.</li>
</ol>
<h2 id="5-winrar-private-key-generation-algorithm">5. WinRAR private key generation algorithm</h2>
<p>We use </p>
<p style="text-align: center;">
    <img src="http://latex.codecogs.com/svg.latex?T%3Dt_0t_1%20%5Cldots%20t_%7Bl-1%7D%20%5Cquad%20%5Cquad%20t_i%5Cin%5B0%2C256%29">
</p>

<p>to denote input data whose length is <img alt="l-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20l" />. WinRAR use it to generate private key <img alt="k-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20k" />.</p>
<ol>
<li>We use <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20g_0%2Cg_1%2Cg_2%2Cg_3%2Cg_4%2Cg_5" /> to denote 6 32-bits-long integer. So there is</li>
</ol>
<p style="text-align: center;">
       <img src="http://latex.codecogs.com/svg.latex?g_j%3D%5Csum_%7Bi%3D0%7D%5E%7B3%7Dg_%7Bj%2Ci%7D%20%5Ccdot%202%5E%7B8i%7D%20%5Cquad%20%5Cquad%20g_%7Bj%2Ci%7D%5Cin%5B0%2C256%29">
   </p>

<ol>
<li>
<p>Let <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20g_0%3D0" />.</p>
</li>
<li>
<p>If <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20l%5Cneq%200" />, we calculate SHA1 value of <img alt="T-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20T" />. Then assign SHA1 state value <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20S_i" /> to <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20g_%7Bi&plus;1%7D" />:</p>
</li>
</ol>
<p style="text-align: center;">
       <img src="http://latex.codecogs.com/svg.latex?%5Cbegin%7Baligned%7D%20%5Ctextrm%7BSHA%7D_1%28T%29%26%3DS_0%7C%7CS_1%7C%7CS_2%7C%7CS_3%7C%7CS_4%20%5C%5C%20g_1%26%3DS_0%20%5C%5C%20g_2%26%3DS_1%20%5C%5C%20g_3%26%3DS_2%20%5C%5C%20g_4%26%3DS_3%20%5C%5C%20g_5%26%3DS_4%20%5C%5C%20%5Cend%7Baligned%7D">
   </p>

<p>Otherwise, when <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20l%3D0" />, we let </p>
<p style="text-align: center;">
       <img src="http://latex.codecogs.com/svg.latex?%5Cbegin%7Baligned%7D%20g_1%26%3D%5Ctextrm%7B0xeb3eb781%7D%20%5C%5C%20g_2%26%3D%5Ctextrm%7B0x50265329%7D%20%5C%5C%20g_3%26%3D%5Ctextrm%7B0xdc5ef4a3%7D%20%5C%5C%20g_4%26%3D%5Ctextrm%7B0x6847b9d5%7D%20%5C%5C%20g_5%26%3D%5Ctextrm%7B0xcde43b4c%7D%20%5C%5C%20%5Cend%7Baligned%7D">
   </p>

<ol>
<li>Regard <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20g_0" /> as counter, add itself by 1.</li>
</ol>
<p>Calculate SHA1:</p>
<p style="text-align: center;">
       <img src="http://latex.codecogs.com/svg.latex?%5Ctextrm%7BSHA%7D_1%28g_%7B0%2C0%7D%7C%7Cg_%7B0%2C1%7D%7C%7Cg_%7B0%2C2%7D%7C%7Cg_%7B0%2C3%7D%7C%7Cg_%7B1%2C0%7D%7C%7Cg_%7B1%2C1%7D%7C%7C%5Cldots%7C%7Cg_%7B5%2C0%7D%7C%7Cg_%7B5%2C1%7D%7C%7Cg_%7B5%2C2%7D%7C%7Cg_%7B5%2C3%7D%29%3DS_0%7C%7CS_1%7C%7CS_2%7C%7CS_3%7C%7CS_4">
   </p>

<p>We takes the lowest 16 bits of <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20S_0" /> and donote it as <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20k_%7Bg_0%7D" />.</p>
<ol>
<li>
<p>Repeat step 4 again with 14 times.</p>
</li>
<li>
<p>After that, we will get <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20k_1%2Ck_2%2Ck_3%2C%5Cldots%2Ck_%7B15%7D" />. Then output private key</p>
</li>
</ol>
<p style="text-align: center;">
       <img src="http://latex.codecogs.com/svg.latex?k%3D%5Csum_%7Bi%3D1%7D%5E%7B15%7Dk_i%20%5Ccdot%202%5E%7B16i%7D">
   </p>

<h2 id="6-the-private-key-and-public-key-of-winrar">6. The private key and public key of WinRAR</h2>
<p>Private key <img alt="k-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20k" /> is</p>
<p style="text-align: center;">
    <img src="http://latex.codecogs.com/svg.latex?k%3D%5Ctextrm%7B0x59fe6abcca90bdb95f0105271fa85fb9f11f467450c1ae9044b7fd61d65e%7D%20%5Cquad%20%5Cquad%20k%5Cin%5Cnolinebreak%5Cmathbb%7BZ%7D">
</p>

<p>This private key is generated by the algorithm describled in section 5 where the length of data <img alt="T-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20T" /> is zero.</p>
<p>Public key <img alt="P-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20P" /> is</p>
<p style="text-align: center;">
    <img src="http://latex.codecogs.com/svg.latex?%5Cbegin%7Baligned%7D%20P%26%3D%28P_x%2CP_y%29%20%5C%5C%20P_x%26%3D%5Ctextrm%7B0x3861220ed9b36c9753df09a159dfb148135d495db3af8373425ee9a28884ba1a%7D%20%5Cquad%20P_x%5Cin%5Ctextrm%7BGF%7D%28%282%5E%7B15%7D%29%5E%7B17%7D%29%20%5C%5C%20P_y%26%3D%5Ctextrm%7B0x12b64e62db43a56114554b0cbd573379338cea9124c8443c4f50e6c8b013ec20%7D%20%5Cquad%20P_y%5Cin%5Ctextrm%7BGF%7D%28%282%5E%7B15%7D%29%5E%7B17%7D%29%20%5Cend%7Baligned%7D">
</p>

<h2 id="7-generation-of-rarregkey">7. Generation of "rarreg.key"</h2>
<p>The generation of license file <code>rarreg.key</code> requires 2 arguments:</p>
<ol>
<li>Username, an ANSI-encoded string, without null-terminator. Denoted as</li>
</ol>
<p style="text-align: center;">
       <img src="http://latex.codecogs.com/svg.latex?U%3Du_0u_1%20%5Cldots%20u_%7Bl-1%7D">
   </p>

<ol>
<li>License type, an ANSI-encoded string, without null-terminator. Denoted as </li>
</ol>
<p style="text-align: center;">
       <img src="http://latex.codecogs.com/svg.latex?L%3Dl_0l_1%20%5Cldots%20l_%7Bl-1%7D">
   </p>

<p>The following is the algorithm to generate <code>rarreg.key</code>.</p>
<ol>
<li>Use the algorithm describled in section 5, with argument <img alt="UU-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20U" />, to generate private key <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20k_U" /> and public key <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20P_U" />. Then output hexlified public key string with SM2 compressed public key format. The hexlified public key is denoted as <img alt="Temp-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20Temp" />.</li>
</ol>
<p>The length of <img alt="Temp-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20Temp" /> should be 64. If less, pad with <code>'0'</code> until the length is 64.</p>
<ol>
<li>Let <img alt="Data3-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20Data%5E3" /> be </li>
</ol>
<p style="text-align: center;">
       <img src="http://latex.codecogs.com/svg.latex?Data%5E3%3D%5Ctexttt%7B%2260%22%7D%7C%7CTemp_0%7C%7CTemp_1%7C%7C%5Cldots%7C%7CTemp_%7B47%7D">
   </p>

<ol>
<li>Use the algorithm describled in section 5, with argument <img alt="Data3-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20Data%5E3" />, to generate private key <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20k_%7BData%5E3%7D" /> and public key <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20P_%7BData%5E3%7D" />. Then output hexlified public key string with SM2 compressed public key format. The hexlified public key is denoted as <img alt="Data0-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20Data%5E0" />.</li>
</ol>
<p>The length of <img alt="Data0-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20Data%5E0" /> should be 64. If less, pad with <code>'0'</code> until the length is 64.</p>
<ol>
<li>Let <img alt="UID-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20UID" /> be</li>
</ol>
<p style="text-align: center;">
       <img src="http://latex.codecogs.com/svg.latex?UID%3DTemp_%7B48%7D%7C%7CTemp_%7B49%7D%7C%7C%5Cldots%7C%7CTemp_%7B63%7D%7C%7CData%5E0_0%7C%7CData%5E0_1%7C%7CData%5E0_2%7C%7CData%5E0_3">
   </p>

<ol>
<li>Use the algorithm describled in section 4, with argument <img alt="LL-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20L" /> and private key <img alt="k-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20k" /> describled section 6, to get signature <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20%28r_L%2Cs_L%29" />.</li>
</ol>
<p>The bit length of <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20r_L" /> and <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20s_L" /> shall not be more than 240. Otherwise, repeat this step.</p>
<ol>
<li>Convert <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20r_L" /> and <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20s_L" /> to hex-integer string <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20SZ%5E%7Br_L%7D" /> and <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20SZ%5E%7Bs_L%7D" />, without <code>"0x"</code> prefix. </li>
</ol>
<p>If the length of <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20SZ%5E%7Br_L%7D" /> or <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20SZ%5E%7Bs_L%7D" /> is less than 60, pad character <code>'0'</code> until the length is 60.</p>
<ol>
<li>Let <img alt="Data1-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20Data%5E1" /> be</li>
</ol>
<p style="text-align: center;">
       <img src="http://latex.codecogs.com/svg.latex?Data%5E1%3D%5Ctexttt%7B%2260%22%7D%7C%7CSZ%5E%7Bs_L%7D%7C%7CSZ%5E%7Br_L%7D">
   </p>

<ol>
<li>Let <img alt="Temp-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20Temp" /> be </li>
</ol>
<p style="text-align: center;">
       <img src="http://latex.codecogs.com/svg.latex?Temp%3DU%7C%7CData%5E0">
   </p>

<p>Use the algorithm describled in section 4, with argument <img alt="Temp-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20Temp" /> and private key <img alt="k-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20k" /> describled section 6, to get signature <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20%28r_%7BTemp%7D%2Cs_%7BTemp%7D%29" />.</p>
<p>The bit length of <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20r_%7BTemp%7D" /> and <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20s_%7BTemp%7D" /> shall not be more than 240. Otherwise, repeat this step.</p>
<ol>
<li>Convert <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20r_%7BTemp%7D" /> and <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20s_%7BTemp%7D" /> to hex-integer string <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20SZ%5E%7Br_%7BTemp%7D%7D" /> and <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20SZ%5E%7Bs_%7BTemp%7D%7D" />, without <code>"0x"</code> prefix. </li>
</ol>
<p>If the length of <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20SZ%5E%7Br_%7BTemp%7D%7D" /> or <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20SZ%5E%7Bs_%7BTemp%7D%7D" /> is less than 60, pad character <code>'0'</code> until the length is 60.</p>
<ol>
<li>
<p>Let <img alt="Data2-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20Data%5E2" /> be</p>
<p><p style="text-align: center;">
    <img src="http://latex.codecogs.com/svg.latex?Data%5E2%3D%5Ctexttt%7B%2260%22%7D%7C%7CSZ%5E%7Bs_%7BTemp%7D%7D%7C%7CSZ%5E%7Br_%7BTemp%7D%7D">
</p></p>
</li>
<li>
<p>Calculate CRC32 value of </p>
<p><p style="text-align: center;">
    <img src="http://latex.codecogs.com/svg.latex?L%7C%7CU%7C%7CData%5E0%7C%7CData%5E1%7C%7CData%5E2%7C%7CData%5E3">
</p></p>
<p>The final checksum the complement of CRC32 value. </p>
<p>Then convert the checksum to decimal string <img alt="" src="http://latex.codecogs.com/svg.latex?%5Cinline%20SZ%5E%7Bchecksum%7D" />. If the length is less than 10, pad character <code>'0'</code> until the length is 10.</p>
</li>
<li>
<p>Let <img alt="Data-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20Data" /> be </p>
<p><p style="text-align: center;">
    <img src="http://latex.codecogs.com/svg.latex?%5Cinline%20Data%3DData%5E0%7C%7CData%5E1%7C%7CData%5E2%7C%7CData%5E3%7C%7CSZ%5E%7Bchecksum%7D">
</p></p>
</li>
<li>
<p>Output with format</p>
<ul>
<li>
<p>A fixed header <code>"RAR registration data"</code>, taking one line.</p>
</li>
<li>
<p>Username, taking one line.</p>
</li>
<li>
<p>License type, taking one line</p>
</li>
<li>
<p>UID, taking one line, with format:</p>
</li>
</ul>
<p><p style="text-align: center;">
    <img src="http://latex.codecogs.com/svg.latex?%5Ctexttt%7B%22UID%3D%22%7D%7C%7CUID">
  </p></p>
<ul>
<li>Output <img alt="Data-inlined" src="http://latex.codecogs.com/svg.latex?%5Cinline%20Data" />, with 54 characters a line.</li>
</ul>
</li>
</ol>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href=".." class="btn btn-neutral float-left" title="WinRAR Key File Generator."><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../GF/" class="btn btn-neutral float-right" title="Arithmetic on the Galois Field GF(2<sup>n</sup>) and GF((2<sup>n</sup>)<sup>m</sup>).">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/YJTSAI-17/WinRAR-KeyGen-Online" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href=".." style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../GF/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
